Potato Disease Segmentation

Overview

This repository contains the code and resources for a potato disease segmentation project. The goal is to segment potato leaf images into diseased and healthy regions using a U-Net model. The dataset is derived from the PlantVillage dataset, focusing on potato leaf images categorized into three classes: Early Blight (E_B), Late Blight (L_B), and Healthy. The segmentation masks are generated through a multi-step process involving annotation, conversion, and color space manipulation, followed by training a U-Net model for 20 epochs.

Folder Structure

PlantVillage_images/: Contains the original potato leaf images, categorized into three classes:
E_B/: Images of potato leaves with Early Blight.
L_B/: Images of potato leaves with Late Blight.
Healthy/: Images of healthy potato leaves.


PlantVillage_red_masks/: Contains the initial segmentation masks in PNG format with red foreground (diseased regions) and black background (healthy regions).
Black_white_masks/: Contains the processed segmentation masks in PNG format with white foreground (diseased regions) and black background (healthy regions).


Files

(Labelme)_json_to_png.ipynb: A Jupyter notebook that converts JSON annotation files (generated by the LabelMe tool) into PNG masks with red foreground and black background.
black_white_mask_by_hsv.py: A Python script that converts the red-foreground masks from PlantVillage_red_masks into white-foreground masks (stored in Black_white_masks) using HSV color space. It generates two partial masks to capture lighter and darker variants of red, then combines them using a binary OR operation to produce the final mask.
UNET_20_epochs.ipynb: A Jupyter notebook that implements and trains a U-Net model for 20 epochs using the images from PlantVillage_images and the processed masks from Black_white_masks for segmentation.


Workflow

Data Collection:

Potato leaf images are sourced from the PlantVillage dataset and organized into three categories: Early Blight (E_B), Late Blight (L_B), and Healthy.


Annotation:

The images are annotated using the LabelMe tool, which generates JSON files representing the segmentation masks for diseased regions.


Mask Conversion (JSON to PNG):

The (Labelme)_json_to_png.ipynb notebook converts the JSON annotations into PNG masks.
These masks have a red foreground (diseased areas) and a black background (healthy areas) and are stored in the PlantVillage_red_masks folder.


Mask Processing (Red to White):

The black_white_mask_by_hsv.py script processes the red-foreground masks to convert them into white-foreground masks.
It uses the HSV color space to detect red regions, creating two partial masks for lighter and darker red shades.
A binary OR operation combines the partial masks to produce the final white-foreground mask, which is saved in the Black_white_masks folder.


Model Training:

The UNET_20_epochs.ipynb notebook trains a U-Net model for 20 epochs.
The model takes the original images from PlantVillage_images and the processed masks from Black_white_masks as input to learn segmentation of diseased regions.




Prerequisites
To run the code in this repository, ensure you have the following installed:

Python 3.x
Jupyter Notebook
Required Python libraries (install via pip):
labelme (for JSON-to-PNG conversion)
opencv-python (for image processing in HSV color space)
numpy (for numerical operations)
tensorflow or pytorch (depending on the U-Net implementation in UNET_20_epochs.ipynb)
Other dependencies as required by the notebooks (e.g., matplotlib for visualization)




Usage

Clone the Repository:
git clone https://github.com/Napoleon-coder-2003/Potato_disease_segmentation.git
cd Potato_disease_segmentation


Set Up the Environment:

Install the required libraries:pip install labelme opencv-python numpy tensorflow


Ensure the folder structure matches the one described above.


Convert JSON Annotations to PNG Masks:

Open the (Labelme)_json_to_png.ipynb notebook in Jupyter:jupyter notebook (Labelme)_json_to_png.ipynb


Run the notebook to convert JSON annotations into PNG masks and save them in PlantVillage_red_masks.


Process Red Masks to White Masks:

Run the black_white_mask_by_hsv.py script to convert the red-foreground masks into white-foreground masks:python black_white_mask_by_hsv.py


The output masks will be saved in Black_white_masks.


Train the U-Net Model:

Open the UNET_20_epochs.ipynb notebook in Jupyter:jupyter notebook UNET_20_epochs.ipynb


Run the notebook to train the U-Net model for 20 epochs. Ensure the paths to PlantVillage_images and Black_white_masks are correctly specified in the notebook.




Results

The trained U-Net model can segment potato leaf images into diseased and healthy regions.
The segmentation masks in Black_white_masks serve as ground truth for training and evaluation.
After training, the model can be used to predict segmentation masks for new potato leaf images.


Future Improvements

Increase the number of training epochs or adjust the U-Net architecture for better performance.
Augment the dataset with more images to improve model generalization.
Experiment with different color spaces or thresholding techniques for mask generation.
Add evaluation metrics (e.g., IoU, Dice coefficient) to quantify the segmentation performance.


License
This project is licensed under the MIT License. See the LICENSE file for details.

Contact
For any questions or contributions, please reach out via the GitHub repository: Napoleon-coder-2003/Potato_disease_segmentation.
